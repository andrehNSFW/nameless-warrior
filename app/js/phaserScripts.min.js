var NWarrior=NWarrior||{};NWarrior.Character=function(t){this["class"],this.nickname,this.str,this.con,this.dex,this["int"],this.cha,this.hp,this.mana,this.stamina,this.hunger,this.sleep,Phaser.Sprite.call(this,t,t.world.randomX,t.world.randomY,"player"),this.create()},NWarrior.Character.prototype=Object.create(Phaser.Sprite.prototype),NWarrior.Character.prototype.constructor=NWarrior.Character,NWarrior.Character.prototype.create=function(){this.game.add.existing(this),this.frame=1,this.game.physics.arcade.enable(this),this.body.collideWorldBounds=!0,this.game.camera.follow(this),this.cursors=this.game.input.keyboard.createCursorKeys(),gameUtils.walkAnimations(this)},NWarrior.Character.prototype.update=function(){gameUtils.walkCursors(this.cursors,this)};var NWarrior=NWarrior||{};NWarrior.Enemy=function(t){this.type,this.str,this.con,this.dex,this["int"],this.cha,this.hp,this.mana,this.stamina,this.hunger,this.sleep,Phaser.Sprite.call(this,t,t.world.randomX,t.world.randomY,"Enemy"),this.create()},NWarrior.Enemy.prototype=Object.create(Phaser.Sprite.prototype),NWarrior.Enemy.prototype.constructor=NWarrior.Enemy,NWarrior.Enemy.prototype.create=function(){};var NWarrior=NWarrior||{},gameWidth=$(".game__wrapper").width(),gameHeight=window.innerHeight;NWarrior.game=function(){this.init()},NWarrior.game.prototype={init:function(){NWarrior.game=new Phaser.Game(gameWidth,gameHeight,Phaser.AUTO,"phaser"),NWarrior.game.state.add("Boot",NWarrior.Boot),NWarrior.game.state.add("Game",NWarrior.Game),NWarrior.game.state.start("Boot")}};var gameUtils={walkAnimations:function(t){t.animations.add("down",[1,0,2],10,!0),t.animations.add("left",[4,3,5],10,!0),t.animations.add("right",[7,6,8],10,!0),t.animations.add("up",[10,9,11],10,!0)},walk:function(t,a,r){switch(r=r||50,t){case"down":this.lastFrame=1,a.body.velocity.y=r,a.body.velocity.x=0;break;case"up":this.lastFrame=10,a.body.velocity.y=-r,a.body.velocity.x=0;break;case"left":this.lastFrame=4,a.body.velocity.x=-r,a.body.velocity.y=0;break;case"right":this.lastFrame=7,a.body.velocity.y=0,a.body.velocity.x=r;break;case"stop":a.body.velocity.x=0,a.body.velocity.y=0,a.animations.stop()}a.animations.play(t)},walkCursors:function(t,a,r){var i;r=r||150,i=t.left.isDown?"left":t.right.isDown?"right":t.up.isDown?"up":t.down.isDown?"down":"stop",this.walk(i,a,r)},randomWalk:function(t,a){var r=this,a=a||150;setInterval(function(){var i=Math.floor(5*Math.random())+1;switch(i){case 1:r.walk("down",t,a);break;case 2:r.walk("up",t,a);break;case 3:r.walk("left",t,a);break;case 4:r.walk("right",t,a);break;case 5:r.walk("stop",t,a)}},1e3)}},NWarrior=NWarrior||{};NWarrior.Hud=function(t){this.game=t,this.create()},NWarrior.Hud.prototype={create:function(){var t={x:140,y:30,height:20,bar:{color:"#940000"},bg:{color:"#000000"}},a={x:140,y:60,height:20,bar:{color:"#5368EE"},bg:{color:"#000000"}};this.healthBar=new HealthBar(this.game,t),this.manaBar=new HealthBar(this.game,a)},turnAudio:function(t){1==this.music.mute?this.music.mute=!1:this.music.mute=!0}};var NWarrior=NWarrior||{};NWarrior.Map=function(t){this.game=t,this.create()},NWarrior.Map.prototype={create:function(){this.map=this.game.add.tilemap("sampleMap");var t=this.map.widthInPixels,a=this.map.heightInPixels;this.game.world.setBounds(0,0,t,a),this.map.addTilesetImage("TileCraftGroundSet","tiles"),this.ground=this.map.createLayer("layer1"),this.ground.resizeWorld()}};var NWarrior=NWarrior||{};NWarrior.Npc=function(t){this.type,this.str,this.con,this.dex,this["int"],this.cha,this.hp,this.mana,this.stamina,this.hunger,this.sleep,Phaser.Sprite.call(this,t,t.world.randomX,t.world.randomY,"npc"),this.create()},NWarrior.Npc.prototype=Object.create(Phaser.Sprite.prototype),NWarrior.Npc.prototype.constructor=NWarrior.Character,NWarrior.Npc.prototype.create=function(){this.game.add.existing(this),this.game.physics.arcade.enable(this),this.body.collideWorldBounds=!0,this.frame=4,this.enableBody=!0,gameUtils.walkAnimations(this),gameUtils.randomWalk(this,50)},NWarrior.Npc.prototype.update=function(){};var NWarrior=NWarrior||{};NWarrior.Boot=function(){},NWarrior.Boot.prototype={preload:function(){this.loadingStyle={font:"18px Helvetica",fill:"#fff"},this.loading=this.game.add.text(this.game.world.centerX,this.game.world.centerY,"Carregando...",this.loadingStyle),this.loading.anchor.setTo(.5),this.game.load.spritesheet("player","img/char2.png",31,32),this.game.load.spritesheet("npc","img/char3.png",31,32),this.game.load.tilemap("sampleMap","tiles/sample_map2.json",null,Phaser.Tilemap.TILED_JSON),this.game.load.image("tiles","tiles/TileCraftGroundSet.png"),this.game.load.audio("backgroundMusic","audio/RetroMystic.ogg"),this.game.load.image("settings","img/wrench.png"),this.game.load.image("audio","img/audioOn.png")},create:function(){NWarrior.game.state.start("Game")}};var NWarrior=NWarrior||{};NWarrior.Game=function(){this.npcsNumber=10,this.loadData()},NWarrior.Game.prototype={create:function(){this.game.time.advancedTiming=!0,this.game.stage.backgroundColor="#00CC66",this.player=new NWarrior.Character(this.game),this.npcs=[],this.npcsGroup=this.game.add.group();for(var t=0;t<this.npcsNumber;t++)this.npcs[t]=new NWarrior.Npc(this.game),this.npcsGroup.add(this.npcs[t]);this.hud=new NWarrior.Hud(this.game)},update:function(){this.game.physics.arcade.collide(this.player,this.npcsGroup)},render:function(){this.game.debug.text(this.game.time.fps||"--",10,650,"#000")},loadData:function(){var t=sessionStorage.getItem("token"),a=window.location.search.replace("?characterId=","");console.log(t),t?$.ajax({url:config.apiURL+"characters/"+a,type:"get",headers:{"x-access-token":t},success:function(t){this.character=t,console.log(t)}}):window.location.assign("/")}};