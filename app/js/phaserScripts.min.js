var NWarrior=NWarrior||{};NWarrior.Character=function(a){this["class"],this.nickname,this.str,this.con,this.dex,this["int"],this.cha,this.hp,this.mana,this.stamina,this.hunger,this.sleep,Phaser.Sprite.call(this,a,a.world.randomX,a.world.randomY,"player"),this.create()},NWarrior.Character.prototype=Object.create(Phaser.Sprite.prototype),NWarrior.Character.prototype.constructor=NWarrior.Character,NWarrior.Character.prototype.create=function(){this.game.add.existing(this),this.frame=1,this.game.physics.arcade.enable(this),this.body.collideWorldBounds=!0,this.game.camera.follow(this),this.cursors=this.game.input.keyboard.createCursorKeys(),gameUtils.walkAnimations(this)},NWarrior.Character.prototype.update=function(){gameUtils.walkCursors(this.cursors,this)};var NWarrior=NWarrior||{};NWarrior.Enemy=function(a){this.type,this.str,this.con,this.dex,this["int"],this.cha,this.hp,this.mana,this.stamina,this.hunger,this.sleep,Phaser.Sprite.call(this,a,a.world.randomX,a.world.randomY,"Enemy"),this.create()},NWarrior.Enemy.prototype=Object.create(Phaser.Sprite.prototype),NWarrior.Enemy.prototype.constructor=NWarrior.Enemy,NWarrior.Enemy.prototype.create=function(){};var NWarrior=NWarrior||{},gameWidth=$(".game__wrapper").width(),gameHeight=window.innerHeight;NWarrior.game=function(){this.init()},NWarrior.game.prototype={init:function(){NWarrior.game=new Phaser.Game(gameWidth,gameHeight,Phaser.AUTO,"phaser"),NWarrior.game.state.add("Boot",NWarrior.Boot),NWarrior.game.state.add("Game",NWarrior.Game),NWarrior.game.state.start("Boot")}};var gameUtils={walkAnimations:function(a){a.animations.add("down",[1,0,2],10,!0),a.animations.add("left",[4,3,5],10,!0),a.animations.add("right",[7,6,8],10,!0),a.animations.add("up",[10,9,11],10,!0)},walk:function(a,t,r){switch(r=r||50,a){case"down":this.lastFrame=1,t.body.velocity.y=r,t.body.velocity.x=0;break;case"up":this.lastFrame=10,t.body.velocity.y=-r,t.body.velocity.x=0;break;case"left":this.lastFrame=4,t.body.velocity.x=-r,t.body.velocity.y=0;break;case"right":this.lastFrame=7,t.body.velocity.y=0,t.body.velocity.x=r;break;case"stop":t.body.velocity.x=0,t.body.velocity.y=0,t.animations.stop()}t.animations.play(a)},walkCursors:function(a,t,r){var i;r=r||150,i=a.left.isDown?"left":a.right.isDown?"right":a.up.isDown?"up":a.down.isDown?"down":"stop",this.walk(i,t,r)},randomWalk:function(a,t){var r=this,t=t||150;setInterval(function(){var i=Math.floor(5*Math.random())+1;switch(i){case 1:r.walk("down",a,t);break;case 2:r.walk("up",a,t);break;case 3:r.walk("left",a,t);break;case 4:r.walk("right",a,t);break;case 5:r.walk("stop",a,t)}},1e3)}},NWarrior=NWarrior||{};NWarrior.Hud=function(a){this.game=a,this.create()},NWarrior.Hud.prototype={create:function(){var a={x:140,y:30,height:20,bar:{color:"#940000"},bg:{color:"#000000"}},t={x:140,y:60,height:20,bar:{color:"#5368EE"},bg:{color:"#000000"}};this.healthBar=new HealthBar(this.game,a),this.manaBar=new HealthBar(this.game,t)},turnAudio:function(a){1==this.music.mute?this.music.mute=!1:this.music.mute=!0}};var NWarrior=NWarrior||{};NWarrior.Map=function(a){this.game=a,this.create()},NWarrior.Map.prototype={create:function(){this.map=this.game.add.tilemap("sampleMap");var a=this.map.widthInPixels,t=this.map.heightInPixels;this.game.world.setBounds(0,0,a,t),this.map.addTilesetImage("TileCraftGroundSet","tiles"),this.ground=this.map.createLayer("layer1"),this.ground.resizeWorld()}};var NWarrior=NWarrior||{};NWarrior.Npc=function(a){this.type,this.str,this.con,this.dex,this["int"],this.cha,this.hp,this.mana,this.stamina,this.hunger,this.sleep,Phaser.Sprite.call(this,a,a.world.randomX,a.world.randomY,"npc"),this.create()},NWarrior.Npc.prototype=Object.create(Phaser.Sprite.prototype),NWarrior.Npc.prototype.constructor=NWarrior.Character,NWarrior.Npc.prototype.create=function(){this.game.add.existing(this),this.game.physics.arcade.enable(this),this.body.collideWorldBounds=!0,this.frame=4,this.enableBody=!0,gameUtils.walkAnimations(this),gameUtils.randomWalk(this,50)},NWarrior.Npc.prototype.update=function(){};var NWarrior=NWarrior||{};NWarrior.Boot=function(){},NWarrior.Boot.prototype={preload:function(){this.loadingStyle={font:"18px Helvetica",fill:"#fff"},this.loading=this.game.add.text(this.game.world.centerX,this.game.world.centerY,"Carregando...",this.loadingStyle),this.loading.anchor.setTo(.5),this.game.load.spritesheet("player","img/char2.png",31,32),this.game.load.spritesheet("npc","img/char3.png",31,32),this.game.load.tilemap("sampleMap","tiles/sample_map2.json",null,Phaser.Tilemap.TILED_JSON),this.game.load.image("tiles","tiles/TileCraftGroundSet.png"),this.game.load.audio("backgroundMusic","audio/RetroMystic.ogg"),this.game.load.image("settings","img/wrench.png"),this.game.load.image("audio","img/audioOn.png")},create:function(){NWarrior.game.state.start("Game")}};var NWarrior=NWarrior||{};NWarrior.Game=function(){this.npcsNumber=10,this.loadData()},NWarrior.Game.prototype={create:function(){this.game.time.advancedTiming=!0,this.game.stage.backgroundColor="#00CC66",this.player=new NWarrior.Character(this.game),this.npcs=[],this.npcsGroup=this.game.add.group();for(var a=0;a<this.npcsNumber;a++)this.npcs[a]=new NWarrior.Npc(this.game),this.npcsGroup.add(this.npcs[a]);this.hud=new NWarrior.Hud(this.game)},update:function(){this.game.physics.arcade.collide(this.player,this.npcsGroup)},render:function(){this.game.debug.text(this.game.time.fps||"--",10,650,"#000")},loadData:function(){var a=localStorage.getItem("NWarriorToken"),t=window.location.search.replace("?characterId=","");console.log(a),a?$.ajax({url:config.apiURL+"characters/"+t,type:"get",headers:{"x-access-token":a},success:function(a){this.character=a,console.log(a)}}):window.location.assign("/")}};