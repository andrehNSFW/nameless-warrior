!function e(t,a,r){function n(o,s){if(!a[o]){if(!t[o]){var c="function"==typeof require&&require;if(!s&&c)return c(o,!0);if(i)return i(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=a[o]={exports:{}};t[o][0].call(u.exports,function(e){var a=t[o][1][e];return n(a?a:e)},u,u.exports,e,t,a,r)}return a[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)n(r[o]);return n}({1:[function(e,t,a){t.exports={apiURL:"http://localhost:8080/"}},{}],2:[function(e,t,a){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),i=function(){function e(t,a){r(this,e),this.trigger=t,this.target=a,this.bindEvents()}return n(e,[{key:"bindEvents",value:function(){var e=this,t=$(this.trigger),a=$(".overlay");t.each(function(){var t=$(this).data("target"),r=$(t),n=r.find(".formbox__close");n.click(function(e){e.preventDefault(),a.removeClass("active"),r.removeClass("active")}),a.click(function(){a.removeClass("active"),r.removeClass("active")}),$(this).click(function(t){t.preventDefault(),a.addClass("active"),e.closeAll(),r.addClass("active")})})}},{key:"closeAll",value:function(){var e=$(".formbox");e.each(function(){$(this).removeClass("active")})}}]),e}();a["default"]=i},{}],3:[function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),o=e("config"),s=r(o),c=e("./Utils"),l=r(c),u=e("./Boxes"),f=r(u),h=function(){function e(){n(this,e),this.utils=new l["default"],this.boxes=new f["default"](".open-formbox",".formbox"),this.formsSelector="form",this.menuNotLogged=$(".menu--not-logged"),this.loggedMenu=$(".menu--logged"),this.notLoggedText=$(".not-logged--text"),this.loggedText=$(".logged--text"),this.loggedInfo=$(".logged--info"),this.bindEvents(),this.checkLogin()}return i(e,[{key:"bindEvents",value:function(){var e=this,t=$(this.formsSelector);t.each(function(){var t=$(this),a=t.data("target"),r=t.find(".formbox__result");t.submit(function(n){var i=e.utils.serializeObject($(this));n.preventDefault(),e.validation(a,t,r)||(e.ajaxPOST(a,r,i),e.cleanForms(t,a,r))})}),$(".logout").click(function(){e.logout()}),$(".character__wrapper").on("click",".character",function(e){var t=$(this).data("character-id");window.location.assign("/game.html?characterId="+t)})}},{key:"validation",value:function(e,t,a){var r=!1;switch(e){case"users":var n=t.find("[name=signupPassword]").val(),i=t.find("[name=signupRepeatPassword]").val();n!=i&&(a.html("The passwords must be equal!"),r=!0);break;case"characters":var o=t.find(".remaining-stats").html();0!=o&&(a.html("You must distribute all attributes!"),r=!0)}return r}},{key:"cleanForms",value:function(e,t){switch(e.find("input[type=text]:not([readonly])").val(""),t){case"characters":e.find(".stats__input").val(5),e.find(".stats__counter").val(10)}}},{key:"ajaxPOST",value:function(e,t,a){var r=this,n=$(".loader"),i=s["default"].apiURL+e;n.addClass("active"),a.token=localStorage.getItem("NWarriorToken"),$.ajax({type:"POST",url:i,data:a,success:function(a){if(n.removeClass("active"),a.failedAuth)return r.logout();switch(e){case"users":r.handleSignUp(a,t);break;case"users/login":r.handleLogin(a,t);break;case"characters":r.handleCharacterCreation(a,t)}},error:function(e,t,a){403==t&&r.logout()}})}},{key:"handleSignUp",value:function(e,t){t.html(e.message),e.created&&setTimeout(function(){$(".overlay").click(),$('[data-target="#formbox-login"]').click()},500)}},{key:"handleLogin",value:function(e,t){t.html(e.message),e.logged&&(setTimeout(function(){$(".overlay").click()},500),this.saveSession(e),this.checkLogin())}},{key:"saveSession",value:function(e){localStorage.setItem("NWarriorUserID",e.userId),localStorage.setItem("NWarriorEmail",e.email),localStorage.setItem("NWarriorToken",e.token)}},{key:"checkLogin",value:function(){localStorage.getItem("NWarriorToken")?(this.loggedInfo.find("span").html(localStorage.getItem("NWarriorEmail")),this.loggedMenu.removeClass("hide"),this.loggedText.removeClass("hide"),this.loggedInfo.removeClass("hide"),this.menuNotLogged.addClass("hide"),this.notLoggedText.addClass("hide"),this.setupCharacterCreation(),this.updateCharacterList()):(this.loggedMenu.addClass("hide"),this.loggedText.addClass("hide"),this.loggedInfo.addClass("hide"),this.menuNotLogged.removeClass("hide"),this.notLoggedText.removeClass("hide"))}},{key:"setupCharacterCreation",value:function(){var e=$('[name="form_create"]'),t=e.find(".stats__group"),a=e.find(".remaining-stats"),r=e.find("[name=characterClass]");r.change(function(){var t=$(this).val();t?e.find(".create__img img").attr("src","img/classes/"+t+".png"):e.find(".create__img img").attr("src","")}),t.each(function(){var e=$(this),t=e.find(".stats__btn--plus"),r=e.find(".stats__btn--minus"),n=e.find(".stats__input");t.click(function(e){e.preventDefault();var t=a.html(),r=n.val();t>0&&(r++,n.val(r),t--,a.html(t))}),r.click(function(e){e.preventDefault();var t=a.html(),r=n.val();t<10&&r>5&&(r--,n.val(r),t++,a.html(t))})}),$("[name=userId]").val(localStorage.getItem("NWarriorUserID"))}},{key:"handleCharacterCreation",value:function(e,t){t.html(e.message),setTimeout(function(){$(".overlay").click(),$('[data-target="#formbox-select"]').click(),t.html(""),$("[name=characterClass]").val(""),$(".create__img img").attr("src","")},500),this.updateCharacterList()}},{key:"updateCharacterList",value:function(){var e=this,t=$(".loader"),a=localStorage.getItem("NWarriorUserID"),r=s["default"].apiURL+"characters/byUser/"+a,n=$(".character__wrapper");t.addClass("active"),$(".character__wrapper > *").remove(),this.utils.getTemplate("characterSelection",function(a){var i=a,o={};o.token=localStorage.getItem("NWarriorToken"),$.ajax({url:r,type:"get",data:o,success:function(a){if(t.removeClass("active"),a.length)for(var r in a){var o=a[r],s=i;s=s.replace("{Nickname}",o.nickname),s=s.replace("{CharacterClass}",e.utils.formatClass(o.characterClass)),s=s.replace("{Strength}",o.strength),s=s.replace("{Constitution}",o.constitution),s=s.replace("{Dexterity}",o.dexterity),s=s.replace("{Intelligence}",o.intelligence),s=s.replace("{Charisma}",o.charisma),s=s.replace("{ClassImg}",o.characterClass),n.append('<div class="character" data-character-id="'+o._id+'">'+s+"</div>")}else n.append('<p>No characters found! Press "New Character" to create your first!</p>')},error:function(t,a,r){e.logout()}})})}},{key:"logout",value:function(){localStorage.clear(),location.reload()}}]),e}();a["default"]=h},{"./Boxes":2,"./Utils":4,config:1}],4:[function(e,t,a){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),i=function(){function e(){r(this,e)}return n(e,[{key:"formatClass",value:function(e){var t=void 0;switch(e){case 1:t="SwordsMan";break;case 2:t="Mage";break;case 3:t="Archer"}return t}},{key:"getTemplate",value:function(e,t){$.get("templates/"+e+".html",function(e){t(e)})}},{key:"serializeObject",value:function(e){var t={},a=e.serializeArray();return $.each(a,function(){t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t}}]),e}();a["default"]=i},{}],5:[function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=e("core/Home"),o=r(i),s=function c(){n(this,c),new o["default"]};$(document).ready(function(){new s})},{"core/Home":3}]},{},[5]);